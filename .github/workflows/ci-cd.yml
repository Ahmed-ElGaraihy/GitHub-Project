name: Website CI/CD

on:
  push:
    branches:
      - main

jobs:
  test:
    name: Check Specs Link and Section
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - name: Test for Specs Link
        run: |
          if ! grep -q 'href="#spec"' index.html; then
            echo "Specs link not found!"
            exit 1
          fi
      - name: Test for Tech Specs Section
        run: |
          if ! grep -q 'id="spec"' index.html; then
            echo "Tech Specs section not found!"
            exit 1
          fi

  build:
    name: Prepare for Deployment
    runs-on: ubuntu-latest
    needs: test
    steps:
      - uses: actions/checkout@v3
      - name: Copy files to build folder
        run: |
          mkdir -p build
          cp index.html style.css *.png *.jpg build/

  deploy:
    name: Deploy to main
    runs-on: ubuntu-latest
    needs: build
    steps:
      - uses: actions/checkout@v3
      - name: Copy build to root
        run: |
          cp -r build/* .
      - name: Commit & Push
        run: |
          git config --global user.name "Ahmed Ibrahim"
          git config --global user.email "your_email@example.com"
          git add .
          git commit -m "Deploy updates"
          git push origin main
